<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Importing Google Trends data</title><title>Importing Google Trends data | HBC Tech</title><meta property="og:title" content="Importing Google Trends data"><meta name="author" content="Igor Elbert"><meta property="og:locale" content="en_US"><meta name="description" content="Google Trends offers a trove of data for analysis. It&rsquo;s not used nearly enough partially because good folks at Google did not provide an API to access the data. You can play with Trends in you browser, embed it into your webpages but it’s not that simple to get the raw data behind it to use it in your analysis. There is a number of packages in Python, Perl, or R that pull the data for you but none of them did when I needed: compare hundreds of trends against each other. You see, not contend with the lack of API Google returns trends on 1 to 100 scale so it’s hard to compare numbers for many different trends. You can plot several trends on the same graph but you will not be able to tell how they stand relative to another set of trends. For example: Above: “Game of Thrones” vs. “House of Cards”.Below: “Orange is New Black” vs. “The Newsroom” Since each set is rescaled there is no way to tell how “House&hellip;” stands against “Orange&hellip;” I needed to get the trends for hundreds of fashion brands Gilt deals with and compare them against each other. The logical solution seemed to use one search term as a baseline in every set and then rescale the results relative to a baseline term. I borrowed heavily from GTrendsR package and came up with a script in R that pulls trends and rescales them relative to baseline. It took some hacking: I took Google Trends export link that looks something like www.google.com/trends/embed.js?hl=en-US&amp;q=/m/06bkdx,+/m/0tlwzvq,+/m/0b6hm_f,+/m/0c5_m3,+/m/0f4w93&amp;geo=US&amp;date=2/2013+25m&amp;cmpt=q&amp;tz&amp;tz&amp;content=1&amp;cid=TIMESERIES_GRAPH_0&amp;export=5 and after looking at various export options found the one (export=3) that returns raw data in JSON-like string. For example: http://www.google.com/trends/fetchComponent?q=%2Fm%2F06bkdx%2C%2Fm%2F0624dh&amp;date=today%207-d&amp;geo=US&amp;cat=0-18&amp;cid=TIMESERIES_GRAPH_0&amp;export=3 returns: // Data table response google.visualization.Query.setResponse( {&quot;version&quot;:&quot;0.6&quot;,&quot;status&quot;:&quot;ok&quot;,&quot;sig&quot;:&quot;881376537&quot;, &quot;table&quot;:{&quot;cols&quot;:[ {&quot;id&quot;:&quot;date&quot;,&quot;label&quot;:&quot;Date&quot;,&quot;type&quot;:&quot;date&quot;,&quot;pattern&quot;:&quot;&quot;}, {&quot;id&quot;:&quot;query0&quot;,&quot;label&quot;:&quot;Agent Provocateur&quot;,&quot;type&quot;:&quot;number&quot;,&quot;pattern&quot;:&quot;&quot;}, {&quot;id&quot;:&quot;query1&quot;,&quot;label&quot;:&quot;Kate Spade&quot;,&quot;type&quot;:&quot;number&quot;,&quot;pattern&quot;:&quot;&quot;} ], &quot;rows&quot;:[{&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,18),&quot;f&quot;:&quot;Saturday, April 18, 2015&quot;}, {&quot;v&quot;:0.0,&quot;f&quot;:&quot;0&quot;},{&quot;v&quot;:77.0,&quot;f&quot;:&quot;77&quot;} ]}, {&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,19),&quot;f&quot;:&quot;Sunday, April 19, 2015&quot;}, {&quot;v&quot;:0.0,&quot;f&quot;:&quot;0&quot;},{&quot;v&quot;:100.0,&quot;f&quot;:&quot;100&quot;} ]}, {&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,20),&quot;f&quot;:&quot;Monday, April 20, 2015&quot;}, {&quot;v&quot;:0.0,&quot;f&quot;:&quot;0&quot;}, {&quot;v&quot;:65.0,&quot;f&quot;:&quot;65&quot;}]}, {&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,21),&quot;f&quot;:&quot;Tuesday, April 21, 2015&quot;}, {&quot;v&quot;:0.0,&quot;f&quot;:&quot;0&quot;},{&quot;v&quot;:62.0,&quot;f&quot;:&quot;62&quot;} ]}, {&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,22),&quot;f&quot;:&quot;Wednesday, April 22, 2015&quot;}, {&quot;v&quot;:0.0,&quot;f&quot;:&quot;0&quot;},{&quot;v&quot;:57.0,&quot;f&quot;:&quot;57&quot;} ]}, {&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,23),&quot;f&quot;:&quot;Thursday, April 23, 2015&quot;}, , {&quot;v&quot;:null} ]},{&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,24),&quot;f&quot;:&quot;Friday, April 24, 2015&quot;}, , {&quot;v&quot;:null} ]}]}}); Which is turned into a valid JSON with 4 lines of R code and then parsed into R data structures with rjson package. The result looks like: And can now be analyzed, plotted, and joined with other data. Because of the powers of SQL/MapReduce in our Teradata Aster database we can pull the trends and join with our relational data on the fly in SQL: SELECT *FROM STREAM ( ON (SELECT brand_name from dim_brands) PARTITION BY brand_name SCRIPT(&lsquo;GTrends_MR.R&rsquo;) OUTPUTS(&#39;week DATE, term VARCHAR, trend INTEGER&rsquo;)) Any comments on Google Trends, R style and overall approach are appreciated. Happy trending!"><meta property="og:description" content="Google Trends offers a trove of data for analysis. It&rsquo;s not used nearly enough partially because good folks at Google did not provide an API to access the data. You can play with Trends in you browser, embed it into your webpages but it’s not that simple to get the raw data behind it to use it in your analysis. There is a number of packages in Python, Perl, or R that pull the data for you but none of them did when I needed: compare hundreds of trends against each other. You see, not contend with the lack of API Google returns trends on 1 to 100 scale so it’s hard to compare numbers for many different trends. You can plot several trends on the same graph but you will not be able to tell how they stand relative to another set of trends. For example: Above: “Game of Thrones” vs. “House of Cards”.Below: “Orange is New Black” vs. “The Newsroom” Since each set is rescaled there is no way to tell how “House&hellip;” stands against “Orange&hellip;” I needed to get the trends for hundreds of fashion brands Gilt deals with and compare them against each other. The logical solution seemed to use one search term as a baseline in every set and then rescale the results relative to a baseline term. I borrowed heavily from GTrendsR package and came up with a script in R that pulls trends and rescales them relative to baseline. It took some hacking: I took Google Trends export link that looks something like www.google.com/trends/embed.js?hl=en-US&amp;q=/m/06bkdx,+/m/0tlwzvq,+/m/0b6hm_f,+/m/0c5_m3,+/m/0f4w93&amp;geo=US&amp;date=2/2013+25m&amp;cmpt=q&amp;tz&amp;tz&amp;content=1&amp;cid=TIMESERIES_GRAPH_0&amp;export=5 and after looking at various export options found the one (export=3) that returns raw data in JSON-like string. For example: http://www.google.com/trends/fetchComponent?q=%2Fm%2F06bkdx%2C%2Fm%2F0624dh&amp;date=today%207-d&amp;geo=US&amp;cat=0-18&amp;cid=TIMESERIES_GRAPH_0&amp;export=3 returns: // Data table response google.visualization.Query.setResponse( {&quot;version&quot;:&quot;0.6&quot;,&quot;status&quot;:&quot;ok&quot;,&quot;sig&quot;:&quot;881376537&quot;, &quot;table&quot;:{&quot;cols&quot;:[ {&quot;id&quot;:&quot;date&quot;,&quot;label&quot;:&quot;Date&quot;,&quot;type&quot;:&quot;date&quot;,&quot;pattern&quot;:&quot;&quot;}, {&quot;id&quot;:&quot;query0&quot;,&quot;label&quot;:&quot;Agent Provocateur&quot;,&quot;type&quot;:&quot;number&quot;,&quot;pattern&quot;:&quot;&quot;}, {&quot;id&quot;:&quot;query1&quot;,&quot;label&quot;:&quot;Kate Spade&quot;,&quot;type&quot;:&quot;number&quot;,&quot;pattern&quot;:&quot;&quot;} ], &quot;rows&quot;:[{&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,18),&quot;f&quot;:&quot;Saturday, April 18, 2015&quot;}, {&quot;v&quot;:0.0,&quot;f&quot;:&quot;0&quot;},{&quot;v&quot;:77.0,&quot;f&quot;:&quot;77&quot;} ]}, {&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,19),&quot;f&quot;:&quot;Sunday, April 19, 2015&quot;}, {&quot;v&quot;:0.0,&quot;f&quot;:&quot;0&quot;},{&quot;v&quot;:100.0,&quot;f&quot;:&quot;100&quot;} ]}, {&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,20),&quot;f&quot;:&quot;Monday, April 20, 2015&quot;}, {&quot;v&quot;:0.0,&quot;f&quot;:&quot;0&quot;}, {&quot;v&quot;:65.0,&quot;f&quot;:&quot;65&quot;}]}, {&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,21),&quot;f&quot;:&quot;Tuesday, April 21, 2015&quot;}, {&quot;v&quot;:0.0,&quot;f&quot;:&quot;0&quot;},{&quot;v&quot;:62.0,&quot;f&quot;:&quot;62&quot;} ]}, {&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,22),&quot;f&quot;:&quot;Wednesday, April 22, 2015&quot;}, {&quot;v&quot;:0.0,&quot;f&quot;:&quot;0&quot;},{&quot;v&quot;:57.0,&quot;f&quot;:&quot;57&quot;} ]}, {&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,23),&quot;f&quot;:&quot;Thursday, April 23, 2015&quot;}, , {&quot;v&quot;:null} ]},{&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,24),&quot;f&quot;:&quot;Friday, April 24, 2015&quot;}, , {&quot;v&quot;:null} ]}]}}); Which is turned into a valid JSON with 4 lines of R code and then parsed into R data structures with rjson package. The result looks like: And can now be analyzed, plotted, and joined with other data. Because of the powers of SQL/MapReduce in our Teradata Aster database we can pull the trends and join with our relational data on the fly in SQL: SELECT *FROM STREAM ( ON (SELECT brand_name from dim_brands) PARTITION BY brand_name SCRIPT(&lsquo;GTrends_MR.R&rsquo;) OUTPUTS(&#39;week DATE, term VARCHAR, trend INTEGER&rsquo;)) Any comments on Google Trends, R style and overall approach are appreciated. Happy trending!"><link rel="canonical" href="https://tech.hbc.com/hbc-tech-blog/2015-05-11-importing-google-trends-data.html"><meta property="og:url" content="https://tech.hbc.com/hbc-tech-blog/2015-05-11-importing-google-trends-data.html"><meta property="og:site_name" content="HBC Tech"><meta property="og:type" content="article"><meta property="article:published_time" content="2015-05-11T12:26:01-05:00"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@"><meta name="twitter:creator" content="@Igor Elbert"><script type="application/ld+json">{"name":null,"description":"Google Trends offers a trove of data for analysis. It&rsquo;s not used nearly enough partially because good folks at Google did not provide an API to access the data. You can play with Trends in you browser, embed it into your webpages but it’s not that simple to get the raw data behind it to use it in your analysis. There is a number of packages in Python, Perl, or R that pull the data for you but none of them did when I needed: compare hundreds of trends against each other. You see, not contend with the lack of API Google returns trends on 1 to 100 scale so it’s hard to compare numbers for many different trends. You can plot several trends on the same graph but you will not be able to tell how they stand relative to another set of trends. For example: Above: “Game of Thrones” vs. “House of Cards”.Below: “Orange is New Black” vs. “The Newsroom” Since each set is rescaled there is no way to tell how “House&hellip;” stands against “Orange&hellip;” I needed to get the trends for hundreds of fashion brands Gilt deals with and compare them against each other. The logical solution seemed to use one search term as a baseline in every set and then rescale the results relative to a baseline term. I borrowed heavily from GTrendsR package and came up with a script in R that pulls trends and rescales them relative to baseline. It took some hacking: I took Google Trends export link that looks something like www.google.com/trends/embed.js?hl=en-US&amp;q=/m/06bkdx,+/m/0tlwzvq,+/m/0b6hm_f,+/m/0c5_m3,+/m/0f4w93&amp;geo=US&amp;date=2/2013+25m&amp;cmpt=q&amp;tz&amp;tz&amp;content=1&amp;cid=TIMESERIES_GRAPH_0&amp;export=5 and after looking at various export options found the one (export=3) that returns raw data in JSON-like string. For example: http://www.google.com/trends/fetchComponent?q=%2Fm%2F06bkdx%2C%2Fm%2F0624dh&amp;date=today%207-d&amp;geo=US&amp;cat=0-18&amp;cid=TIMESERIES_GRAPH_0&amp;export=3 returns: // Data table response google.visualization.Query.setResponse( {&quot;version&quot;:&quot;0.6&quot;,&quot;status&quot;:&quot;ok&quot;,&quot;sig&quot;:&quot;881376537&quot;, &quot;table&quot;:{&quot;cols&quot;:[ {&quot;id&quot;:&quot;date&quot;,&quot;label&quot;:&quot;Date&quot;,&quot;type&quot;:&quot;date&quot;,&quot;pattern&quot;:&quot;&quot;}, {&quot;id&quot;:&quot;query0&quot;,&quot;label&quot;:&quot;Agent Provocateur&quot;,&quot;type&quot;:&quot;number&quot;,&quot;pattern&quot;:&quot;&quot;}, {&quot;id&quot;:&quot;query1&quot;,&quot;label&quot;:&quot;Kate Spade&quot;,&quot;type&quot;:&quot;number&quot;,&quot;pattern&quot;:&quot;&quot;} ], &quot;rows&quot;:[{&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,18),&quot;f&quot;:&quot;Saturday, April 18, 2015&quot;}, {&quot;v&quot;:0.0,&quot;f&quot;:&quot;0&quot;},{&quot;v&quot;:77.0,&quot;f&quot;:&quot;77&quot;} ]}, {&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,19),&quot;f&quot;:&quot;Sunday, April 19, 2015&quot;}, {&quot;v&quot;:0.0,&quot;f&quot;:&quot;0&quot;},{&quot;v&quot;:100.0,&quot;f&quot;:&quot;100&quot;} ]}, {&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,20),&quot;f&quot;:&quot;Monday, April 20, 2015&quot;}, {&quot;v&quot;:0.0,&quot;f&quot;:&quot;0&quot;}, {&quot;v&quot;:65.0,&quot;f&quot;:&quot;65&quot;}]}, {&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,21),&quot;f&quot;:&quot;Tuesday, April 21, 2015&quot;}, {&quot;v&quot;:0.0,&quot;f&quot;:&quot;0&quot;},{&quot;v&quot;:62.0,&quot;f&quot;:&quot;62&quot;} ]}, {&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,22),&quot;f&quot;:&quot;Wednesday, April 22, 2015&quot;}, {&quot;v&quot;:0.0,&quot;f&quot;:&quot;0&quot;},{&quot;v&quot;:57.0,&quot;f&quot;:&quot;57&quot;} ]}, {&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,23),&quot;f&quot;:&quot;Thursday, April 23, 2015&quot;}, , {&quot;v&quot;:null} ]},{&quot;c&quot;:[ {&quot;v&quot;:new Date(2015,3,24),&quot;f&quot;:&quot;Friday, April 24, 2015&quot;}, , {&quot;v&quot;:null} ]}]}}); Which is turned into a valid JSON with 4 lines of R code and then parsed into R data structures with rjson package. The result looks like: And can now be analyzed, plotted, and joined with other data. Because of the powers of SQL/MapReduce in our Teradata Aster database we can pull the trends and join with our relational data on the fly in SQL: SELECT *FROM STREAM ( ON (SELECT brand_name from dim_brands) PARTITION BY brand_name SCRIPT(&lsquo;GTrends_MR.R&rsquo;) OUTPUTS(&#39;week DATE, term VARCHAR, trend INTEGER&rsquo;)) Any comments on Google Trends, R style and overall approach are appreciated. Happy trending!","author":{"@type":"Person","name":"Igor Elbert"},"@type":"BlogPosting","url":"https://tech.hbc.com/hbc-tech-blog/2015-05-11-importing-google-trends-data.html","publisher":null,"image":null,"headline":"Importing Google Trends data","dateModified":"2015-05-11T12:26:01-05:00","datePublished":"2015-05-11T12:26:01-05:00","sameAs":null,"mainEntityOfPage":{"@type":"WebPage","@id":"https://tech.hbc.com/hbc-tech-blog/2015-05-11-importing-google-trends-data.html"},"@context":"http://schema.org"}</script><meta property="og:title" content="Importing Google Trends data"><meta property="og:type" content="article"><meta property="og:url" content="https://tech.hbc.com/hbc-tech-blog//2015-05-11-importing-google-trends-data.html"><meta property="og:description" content="Google Trends offers a trove of data for analysis. It&amp;rsquo;s not used nearly enough partially because good folks at Google did not provide an API to access ..."><meta property="og:image" content="https://tech.hbc.com/hbc-tech-blog/assets/images/hbc-tech-logo-tipi.jpg"><meta property="og:image:secure_url" content="https://tech.hbc.com/hbc-tech-blog/assets/images/"><meta property="og:image:type" content="image/jpeg"><meta property="og:image:alt"><link rel="stylesheet" href="https://tech.hbc.com/hbc-tech-blog/assets/css/main.css"><link rel="canonical" href="https://tech.hbc.com/hbc-tech-blog/2015-05-11-importing-google-trends-data.html"><link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,700" rel="stylesheet"><link rel="shortcut icon" href="https://tech.hbc.com/hbc-tech-blog/assets/images/favicon.ico"></head><body aria-label="Content"><header id="site-header" class="site-header"><div class="site-header__inner"><a class="site-header__logo" href="https://tech.hbc.com/hbc-tech-blog/"><svg class="hbc-tech-logo" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 64 52"><use class="hbc-tech-logo__text" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/hbc-tech-blog/assets/images/hbc-icons.svg#hbc-tech-logo"></use></svg></a><nav id="menu" class="navigation"><svg class="navigation__menu-icon" xmlns="http://www.w3.org/2000/svg"><path class="bar bar__top" d="M0,3 L30,3"></path><path class="bar bar__cross-1" d="M0,14 L30,14"></path><path class="bar bar__cross-2" d="M0,14 L30,14"></path><path class="bar bar__bottom" d="M0,25 L30,25"></path></svg><menu class="menu"><ul class="link-list"><li class="link-list__link-item"><a href="https://tech.hbc.com/hbc-tech-blog/" class="link-list__link"><span class="link-list__link-highlight">Insights</span></a></li><li class="link-list__link-item"><a href="https://tech.hbc.com/hbc-tech-blog/code" class="link-list__link"><span class="link-list__link-highlight">Code</span></a></li><li class="link-list__link-item"><a href="https://tech.hbc.com/hbc-tech-blog/about" class="link-list__link"><span class="link-list__link-highlight">About</span></a></li><li class="link-list__link-item"><a href="https://tech.hbc.com/hbc-tech-blog/work-here" class="link-list__link"><span class="link-list__link-highlight">Work Here</span></a></li></ul></menu></nav><search id="header-search" class="header-search"><form class="header-search__form"><input type="text" class="header-search__input" id="header-search-input" placeholder="Search" name="query"></form><svg id="header-search__toggle" class="header-search__svg" xmlns="http://www.w3.org/2000/svg"><path id="leftSearch" class="path path--left-half" d="M11.4842576,23.9891168 C5.09608476,23.7189967 0,18.4546255 0,12 C0,5.54951437 4.85419801,0.113423154 12.4763811,0.0114091479"></path><path id="rightSearch" class="path path--right-half" d="M12.5376167,0.0118279089 C18.9155446,0.293025077 24,5.55274344 24,12 C24,18.4701834 17.7604297,24.3112218 11.1896721,23.9909829"></path><path id="handle" class="path path--handle" d="M20.7485408,20.8914207 L26.8571202,27 L20.7485408,20.8914207"></path></svg><section class="header-search__results" id="header-search__results"></section></search></div></header><section class="content"><article class="article"><header class="article__header article__header--reveal"><h1 class="header-title" title="Importing Google Trends data">Importing Google Trends data</h1><span id="no-image-placeholder" class="no-image-placeholder"></span><div class="article-meta"><a href="https://tech.hbc.com/hbc-tech-blog/category/data-science" class="article-meta__category">data science</a> <span class="slug-divider"></span> <span class="article-meta__author">Igor Elbert</span> <span class="slug-divider"></span> <span class="article-meta__date">MAY 11, 2015</span></div></header><section class="article__content article__content--reveal"><div class="article__content__read-time"><span class="read-time" title="Estimated read time"><span class="read-time__text-1">2 min</span> <span class="read-time__text-2">Read</span> <span class="read-time__text-3">Time</span></span></div><div class="article__content__share-buttons"><ul class="share-buttons"><li class="share-buttons__link-item"><a href="https://twitter.com/intent/tweet?text=https://tech.hbc.com/hbc-tech-blog//2015-05-11-importing-google-trends-data.html" class="share-buttons__link" title="Share on Twitter" target="_blank"><svg class="hbc-svg-icon" height="36" width="36" xmlns="http://www.w3.org/2000/svg"><use class="hbc-svg-icon--twitter" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/hbc-tech-blog/assets/images/hbc-icons.svg#twitter"></use></svg></a></li><li class="share-buttons__link-item"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://tech.hbc.com/hbc-tech-blog/&source=/2015-05-11-importing-google-trends-data.html&title=Importing Google Trends data" class="share-buttons__link" title="Share on Linkedin" target="_blank"><svg height="36" width="36" xmlns="http://www.w3.org/2000/svg"><use class="hbc-svg-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/hbc-tech-blog/assets/images/hbc-icons.svg#linkedin"></use></svg></a></li><li class="share-buttons__link-item"><a href="https://www.facebook.com/sharer/sharer.php?u=https://tech.hbc.com/hbc-tech-blog//2015-05-11-importing-google-trends-data.html" class="share-buttons__link" title="Share on Facebook" target="_blank"><svg height="36" width="36" xmlns="http://www.w3.org/2000/svg"><use class="hbc-svg-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/hbc-tech-blog/assets/images/hbc-icons.svg#facebook"></use></svg></a></li><li class="share-buttons__link-item"><a href="https://www.reddit.com/submit?url=https://tech.hbc.com/hbc-tech-blog//2015-05-11-importing-google-trends-data.html" class="share-buttons__link" title="Share on Reddit" target="_blank"><svg height="36" width="36" xmlns="http://www.w3.org/2000/svg"><use class="hbc-svg-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/hbc-tech-blog/assets/images/hbc-icons.svg#reddit"></use></svg></a></li></ul></div><div class="article__content__body"><p>Google Trends offers a trove of data for analysis. It&rsquo;s not used nearly enough partially because good folks at Google did not provide an API to access the data. You can play with Trends in you browser, embed it into your webpages but it’s not that simple to get the raw data behind it to use it in your analysis.</p><p>There is a number of packages in Python, Perl, or R that pull the data for you but none of them did when I needed: compare hundreds of trends against each other.</p><p>You see, not contend with the lack of API Google returns trends on 1 to 100 scale so it’s hard to compare numbers for many different trends. You can plot several trends on the same graph but you will not be able to tell how they stand relative to another set of trends.</p><p>For example:</p><figure data-orig-width="862" data-orig-height="454" class="tmblr-full"><img src="https://41.media.tumblr.com/fd130a29b94fa8eb78c4c47f483af0c4/tumblr_inline_nnn5tfrSND1s6x43z_540.png" alt="image" data-orig-width="862" data-orig-height="454"></figure><p>Above: “Game of Thrones” vs. “House of Cards”.<br>Below: “Orange is New Black” vs. “The Newsroom”</p><p>Since each set is rescaled there is no way to tell how “House&hellip;” stands against “Orange&hellip;”</p><figure data-orig-width="853" data-orig-height="445" class="tmblr-full"><img src="https://41.media.tumblr.com/341bf723fc6c880ec67c3a7a75b2631c/tumblr_inline_nnn61tXHhQ1s6x43z_540.png" alt="image" data-orig-width="853" data-orig-height="445"></figure><p>I needed to get the trends for hundreds of fashion brands Gilt deals with and compare them against each other.</p><p>The logical solution seemed to use one search term as a baseline in every set and then rescale the results relative to a baseline term.</p><p>I borrowed heavily from <a href="https://github.com/dvanclev/GTrendsR" target="_blank">GTrendsR</a> package and came up with a <a href="https://github.com/ielbert/GoogleTrendsScaled" target="_blank"><b><i>script in R</i></b></a> that pulls trends and rescales them relative to baseline.</p><p>It took some hacking: I took Google Trends export link that looks something like</p><p><a href="http://www.google.com/trends/embed.js?hl=en-US&amp;q=/m/06bkdx,+/m/0tlwzvq,+/m/0b6hm_f,+/m/0c5_m3,+/m/0f4w93&amp;geo=US&amp;date=2/2013+25m&amp;cmpt=q&amp;tz&amp;tz&amp;content=1&amp;cid=TIMESERIES_GRAPH_0&amp;" target="_blank">www.google.com/trends/embed.js?hl=en-US&amp;q=/m/06bkdx,+/m/0tlwzvq,+/m/0b6hm_f,+/m/0c5_m3,+/m/0f4w93&amp;geo=US&amp;date=2/2013+25m&amp;cmpt=q&amp;tz&amp;tz&amp;content=1&amp;cid=TIMESERIES_GRAPH_0&amp;</a><b>export=5</b></p><p>and after looking at various export options found the one (export=3) that returns raw data in JSON-like string. For example:</p><p><a href="http://www.google.com/trends/fetchComponent?q=%2Fm%2F065667%2C%20%2Fm%2F06bkdx&amp;date=today%207-d&amp;geo=US&amp;cat=0-18&amp;cid=TIMESERIES_GRAPH_0&amp;export=3" target="_blank"></a><a href="http://www.google.com/trends/fetchComponent?q=%2Fm%2F06bkdx%2C%2Fm%2F0624dh&amp;date=today%207-d&amp;geo=US&amp;cat=0-18&amp;cid=TIMESERIES_GRAPH_0&amp;export=3" target="_blank">http://www.google.com/trends/fetchComponent?q=%2Fm%2F06bkdx%2C%2Fm%2F0624dh&amp;date=today%207-d&amp;geo=US&amp;cat=0-18&amp;cid=TIMESERIES_GRAPH_0&amp;export=3</a><br></p><p>returns:</p><pre>// Data table response
google.visualization.Query.setResponse(
{"version":"0.6","status":"ok","sig":"881376537",
"table":{"cols":[
 {"id":"date","label":"Date","type":"date","pattern":""},
 {"id":"query0","label":"Agent Provocateur","type":"number","pattern":""},
 {"id":"query1","label":"Kate Spade","type":"number","pattern":""}
],
"rows":[{"c":[
 {"v":new Date(2015,3,18),"f":"Saturday, April 18, 2015"},
 {"v":0.0,"f":"0"},{"v":77.0,"f":"77"}
]},
{"c":[
 {"v":new Date(2015,3,19),"f":"Sunday, April 19, 2015"},
 {"v":0.0,"f":"0"},{"v":100.0,"f":"100"}
]},
{"c":[
 {"v":new Date(2015,3,20),"f":"Monday, April 20, 2015"},
 {"v":0.0,"f":"0"},
 {"v":65.0,"f":"65"}]},
{"c":[
 {"v":new Date(2015,3,21),"f":"Tuesday, April 21, 2015"},
 {"v":0.0,"f":"0"},{"v":62.0,"f":"62"}
]},
{"c":[
 {"v":new Date(2015,3,22),"f":"Wednesday, April 22, 2015"},
 {"v":0.0,"f":"0"},{"v":57.0,"f":"57"}
]},
{"c":[
 {"v":new Date(2015,3,23),"f":"Thursday, April 23, 2015"},
 ,
 {"v":null}
]},{"c":[
 {"v":new Date(2015,3,24),"f":"Friday, April 24, 2015"},
 ,
 {"v":null}
]}]}});</pre><p>Which is turned into a valid JSON with 4 lines of R code and then parsed into R data structures with <a href="http://cran.r-project.org/web/packages/rjson/" target="_blank">rjson package</a>.</p><p>The result looks like:</p><figure data-orig-width="609" data-orig-height="142" class="tmblr-full"><img src="https://40.media.tumblr.com/f4994bcf596435d3b3ba381add7d8f6c/tumblr_inline_no78t4SUuZ1s6x43z_540.png" alt="image" data-orig-width="609" data-orig-height="142"></figure><p>And can now be analyzed, plotted, and joined with other data.<br></p><figure data-orig-width="484" data-orig-height="569" class="tmblr-full"><img src="https://40.media.tumblr.com/2e2b52e368283a71dd18c6bd6a6f4751/tumblr_inline_no78txUtGD1s6x43z_540.png" alt="image" data-orig-width="484" data-orig-height="569"></figure><p>Because of the powers of SQL/MapReduce in our Teradata Aster database we can pull the trends and join with our relational data on the fly in SQL:</p><blockquote>SELECT *<br>FROM STREAM (<br>ON (SELECT brand_name from dim_brands)<br>PARTITION BY brand_name<br>SCRIPT(&lsquo;GTrends_MR.R&rsquo;)<br>OUTPUTS('week DATE, term VARCHAR, trend INTEGER&rsquo;)<br>)</blockquote><p>Any comments on Google Trends, R style and overall approach are appreciated.<br></p><p>Happy trending!</p></div><footer class="article__content__footer"><div class="article-tags"><span class="article-tags__tag">analytics</span><span>,</span> <span class="article-tags__tag">Google Trends</span><span>,</span> <span class="article-tags__tag">Data</span><span>,</span> <span class="article-tags__tag">How-To</span></div><section class="author-bio"><svg class="author-bio__avatar" height="36" width="36" xmlns="http://www.w3.org/2000/svg"><use class="hbc-svg-icon hbc-svg-icon--avatar__circle" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/hbc-tech-blog/assets/images/hbc-icons.svg#circle"></use><use class="hbc-svg-icon hbc-svg-icon--avatar__head" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/hbc-tech-blog/assets/images/hbc-icons.svg#head"></use><use class="hbc-svg-icon hbc-svg-icon--avatar__body" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/hbc-tech-blog/assets/images/hbc-icons.svg#body"></use></svg><span class="author-bio__name">Igor Elbert</span></section></footer></section><aside class="recirc"><h2 class="header__title">Recent Insights</h2><span class="slug-divider"></span> <a class="header__view-all-link" href="https://tech.hbc.com/hbc-tech-blog/categories/index.html">See All</a><div class="recirc__articles"><article class="recirc__articles__item"><section class="snippet"><h1 class="snippet__title"><a href="https://tech.hbc.com/hbc-tech-blog/2017-08-04-sundial-batch.html" class="snippet__title__link" title="Sundial or AWS Batch, Why not both?">Sundial or AWS Batch, Why not both?</a></h1><div class="snippet__meta"><a class="meta__category-link" href="https://tech.hbc.com/hbc-tech-blog/category/data-science">data science</a> <span class="slug-divider"></span> <span class="meta__author">Kevin O'Riordan</span> <span class="slug-divider"></span> <span class="meta__date">AUG 4, 2017</span></div><a href="https://tech.hbc.com/hbc-tech-blog/2017-08-04-sundial-batch.html" class="snippet__excerpt__link" title="Sundial or AWS Batch, Why not both?"><p class="snippet__excerpt">About a year ago, we (the Gilt/HBC personalization team) open sourced Sundial , a batch job orchestration system leveraging Amazon EC2 Container Service.</p></a></section></article><article class="recirc__articles__item"><section class="snippet"><h1 class="snippet__title"><a href="https://tech.hbc.com/hbc-tech-blog/2017-07-31-tiefvision-2.html" class="snippet__title__link" title="Visually Similar Recommendations">Visually Similar Recommendations</a></h1><div class="snippet__meta"><a class="meta__category-link" href="https://tech.hbc.com/hbc-tech-blog/category/data-science">data science</a> <span class="slug-divider"></span> <span class="meta__author">Chris Curro</span> <span class="slug-divider"></span> <span class="meta__date">JUL 31, 2017</span></div><a href="https://tech.hbc.com/hbc-tech-blog/2017-07-31-tiefvision-2.html" class="snippet__excerpt__link" title="Visually Similar Recommendations"><p class="snippet__excerpt"></p></a></section></article><article class="recirc__articles__item"><section class="snippet"><h1 class="snippet__title"><a href="https://tech.hbc.com/hbc-tech-blog/2017-05-12-tiefvision-2.html" class="snippet__title__link" title="Visually Similar Recommendations">Visually Similar Recommendations</a></h1><div class="snippet__meta"><a class="meta__category-link" href="https://tech.hbc.com/hbc-tech-blog/category/data-science">data science</a> <span class="slug-divider"></span> <span class="meta__author">Chris Curro</span> <span class="slug-divider"></span> <span class="meta__date">MAY 12, 2017</span></div><a href="https://tech.hbc.com/hbc-tech-blog/2017-05-12-tiefvision-2.html" class="snippet__excerpt__link" title="Visually Similar Recommendations"><p class="snippet__excerpt"></p></a></section></article><article class="recirc__articles__item"><section class="snippet"><h1 class="snippet__title"><a href="https://tech.hbc.com/hbc-tech-blog/2017-04-12-pau-carre-cardona-at-oreilly-ai-conference.html" class="snippet__title__link" title="Pau Carré Cardona To Speak at O'Reilly AI Conference">Pau Carré Cardona To Speak at O'Reilly AI Conference</a></h1><div class="snippet__meta"><a class="meta__category-link" href="https://tech.hbc.com/hbc-tech-blog/category/data-science">data science</a> <span class="slug-divider"></span> <span class="meta__author">HBC Digital</span> <span class="slug-divider"></span> <span class="meta__date">APR 12, 2017</span></div><a href="https://tech.hbc.com/hbc-tech-blog/2017-04-12-pau-carre-cardona-at-oreilly-ai-conference.html" class="snippet__excerpt__link" title="Pau Carré Cardona To Speak at O'Reilly AI Conference"><p class="snippet__excerpt">The O’Reilly Artificial Intelligence Conference is coming to New York City in June. From June 27-29, the top minds in AI will be meeting for “a deep dive into emerging AI techniques and technologies with a focus on how to use it in real-world implementations.”</p></a></section></article></div></aside></article></section><footer class="footer"><svg class="est1670" xmlns="http://www.w3.org/2000/svg"><use class="hbc-tech-logo__use" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/hbc-tech-blog/assets/images/hbc-icons.svg#est1670"></use></svg><section class="footer__links"><ul class="social-links social-links__list"><li class="social-links__list-item"><a class="social-links__link" target="_blank" rel="next" href="https://www.linkedin.com/company/hbc_digital/"><svg class="social-links__icon" xmlns="http://www.w3.org/2000/svg"><use class="linkedin" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/hbc-tech-blog/assets/images/hbc-icons.svg#linkedin"></use></svg></a></li><li class="social-links__list-item"><a class="social-links__link" target="_blank" rel="next" href="https://twitter.com/hbcdigital/"><svg class="social-links__icon" xmlns="http://www.w3.org/2000/svg"><use class="twitter" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/hbc-tech-blog/assets/images/hbc-icons.svg#twitter"></use></svg></a></li><li class="social-links__list-item"><a class="social-links__link" target="_blank" rel="next" href="https://www.instagram.com/hbcdigital"><svg class="social-links__icon" xmlns="http://www.w3.org/2000/svg"><use class="instagram" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/hbc-tech-blog/assets/images/hbc-icons.svg#instagram"></use></svg></a></li></ul><p class="copyright">&copy; 2018 HBC Tech</p></section></footer><script type="text/javascript" src="https://tech.hbc.com/hbc-tech-blog/assets/js/vendor/scrollmagic/ScrollMagic.min.js"></script><script type="text/javascript" src="https://tech.hbc.com/hbc-tech-blog/assets/js/vendor/jekyll-search-js/fetch.js"></script><script type="text/javascript" src="https://tech.hbc.com/hbc-tech-blog/assets/js/vendor/jekyll-search-js/search.js"></script><script type="text/javascript" src="https://tech.hbc.com/hbc-tech-blog/assets/js/main.js"></script><script type="text/javascript" src="https://tech.hbc.com/hbc-tech-blog/assets/js/vendor/snap/snap.svg-min.js"></script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-106560024-1', 'auto');
  ga('send', 'pageview');
</script></body></html>