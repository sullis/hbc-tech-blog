<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title> Sleuthing--and Solving--the User Logout Bug on iOS 7 </title>

        <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Sleuthing–and Solving–the User Logout Bug on iOS 7 | HBC Tech</title>
<meta name="generator" content="Jekyll v3.8.3" />
<meta property="og:title" content="Sleuthing–and Solving–the User Logout Bug on iOS 7" />
<meta name="author" content="HBC Tech" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="iOS 7 brought many new features, and much new work for developers. One of the features the Gilt mobile team was most excited about was background fetch. With background fetch, apps that are running in the background—or not even running at all—can wake up periodically to issue server requests and download data. The purpose is to make the most up-to-date content visible the instant the user brings up an app. In an ideal world, background fetch would kill off the “Loading…” screen that server-driven apps typically present when launched. Background fetch is particularly well-suited for us at Gilt, because we feature a new slate of sales every day. Each day brings updated sale data and new photos to send to the user. Before iOS added support for background fetch, a user would launch the Gilt app (or bring it to the foreground after a certain period of time), and we’d start a flurry of communication with the server that would eventually result in the sales list and associated photos being loaded; the user’s cart and other settings would also get synced. On slow network connections, this process could take a while—costing our users precious time while they raced against other customers before the items in the day’s flash sales sold out. An Unexpected Complication We introduced background fetch in our Gilt for iPhone 4.0 release. Immediately the benefits became apparent: users could access sales much more quickly than before, and they also spent less time in loading-screen limbo. We patted ourselves on the back for a job well done. And then we started to receive bug reports. Users who had logged in and left the “Stay Signed In” option turned on began to report trouble. A day or two (or three) after signing in, these users would suddenly be logged out. They’d sign in again, only to be booted out again within the next few days. Weird. Although we had not seen this issue during our QA testing, we eventually started noticing it on our personal devices. But we could never pin down exactly what we were doing to cause it. As any developer will tell you, repeatable steps to reproduce—the actions a user needs to perform to hit a bug—are critical in diagnosing and fixing problems. After all, how can you be sure you’ve fixed a bug if you don’t know how to trigger it in the first place? We didn’t have steps to reproduce, so we scoured our codebase and tried a number of speculative fixes. We created new test binaries and distributed them to our QA team and internal users. And then we waited a few days to see if everyone who signed in still was. Soon enough, we got the verdict: the bug remained alive. So we’d repeat the cycle again. A LaGuardia Eureka In the middle of all this, I was about to depart on a long-planned vacation. While waiting to board a plane at LaGuardia, I fired up the Delta app to retrieve my boarding pass. Despite having just logged in a few minutes earlier, I noticed that I was being asked to log in again. I had used the Delta app under iOS 6, so I knew the normal behavior was to keep me logged in. I logged in again, and as a test, put the app in the background. A few minutes later, I returned, and again I was logged out. I tried a few other apps, and noticed that Gilt and Delta weren’t the only apps bitten by the user logout bug. Going on vacation gave me a reason to use the Delta app, which in turn provided the Eureka moment that pointed me in a different direction. Gilt’s mobile team had been working under the assumption that the user logout issue was specific to our app. But now the problem appeared to be widespread—a hunch confirmed by The Verge’s Ellis Hamburger—and this gave us a starting point for researching the problem. When iOS 7 became available, the nuances of background fetch weren’t immediately obvious to developers. There was a temptation to approach this new feature with the attitude: Great! I’ll just take the network requests my app makes at launch, and put them in a background fetch wrapper. How easy is that? Not that easy, it turns out. Because background fetch changes the environment in which an app’s networking code executes, the same code won’t necessarily behave the same way when running in the background. The Source of Our Trouble In the case of the user logout bug, the problem was that the iOS Keychain wasn’t consistently available when we’d try to access it. The Keychain is the recommended place for storing sensitive information like usernames and passwords. When data is put in the Keychain, iOS ensures that it is stored securely. By default, when running on phones with a lock code, secure Keychain items remain encrypted while the lock screen is on; they only become available after the owner enters the correct code—or successfully scans a fingerprint—to unlock the device. This ensures that someone gaining physical access to your phone can’t perform a basic forensic analysis to extract sensitive data from your Keychain. Before background fetch, most apps could assume that their secure Keychain items would be available whenever they were needed, because most apps didn’t expect to be performing routine operations—much less be running—when the lock screen was on. However, with background fetch, it is now possible for an app to wake up while the device is locked, when its Keychain items aren’t available. The Gilt app periodically re-authenticates with the server and syncs the items in the user’s cart. This ensures a seamless cross-device experience for our users. However, it was also the source of our user logout bug, because our authentication requests would sometimes get issued in the background when the device was locked. In such a case, the Gilt app would dutifully ask the Keychain for the user’s credentials. But because the device was locked, the Keychain would return a null value, causing the app to behave as though there were no user credentials at all. As far as the app is concerned, no credentials == no user, so the next time the user began interacting with the app, they’d no longer be logged in. We never caught this problem in our internal QA testing, because we didn’t have lock codes on our test devices. Don’t Decrease Default Security After discovering that Keychain access was the source of the issue, we sought to find out how other developers approached solving it. One popular suggestion is to store items in the Keychain with the kSecAttrAccessible attribute set to kSecAttrAccessibleAlways. Unfortunately, this requires using a less secure mechanism for storing data than the Keychain would otherwise use by default. If the only way for your app to function correctly during a background fetch depends on loosening security settings, you should seriously consider refactoring your code. The kSecAttrAccessibleAlways setting allows data to remain unencrypted while the device is locked. The stored data will not be secure if someone manages to gain physical access to your device. At Gilt, we need to be extremely careful about how we handle sensitive data. If we’re going to explicitly change a default security setting, we’re going to tighten that setting, not loosen it. Instead of reducing the security of what we store in the Keychain, we changed our request model to ensure that authentication never needs to be done in the background. If the Keychain isn’t available, we simply won’t try to authenticate. This solution addresses only half the problem, though. In an ideal world, we’d still be able to authenticate and sync the cart sometime before—or at least when—the app becomes active, to ensure that the user always sees the current cart items. If the device is locked, we need to be notified when the Keychain becomes available again, so we’ll know when it is safe to build the necessary server requests. Knowing When the Keychain is Ready The key is hooking into the UIApplicationDelegate&rsquo;s applicationProtectedDataDidBecomeAvailable: method. iOS calls this method after the device has become unlocked, so it serves as a signal that we can now get the user’s authentication credentials from the Keychain. This method can be called before the app is brought to the foreground, letting us get a head start with the cart sync. Although rethinking our server requests for a background fetch world required a little more work, we avoided undermining iOS’s default security settings. And since we rolled out this change in our recent Gilt for iPhone 4.0.2 release, we’ve received no more user reports about this problem. The moral of the story? When faced with a seemingly intractable problem, take a vacation. You might find inspiration in unexpected ways." />
<meta property="og:description" content="iOS 7 brought many new features, and much new work for developers. One of the features the Gilt mobile team was most excited about was background fetch. With background fetch, apps that are running in the background—or not even running at all—can wake up periodically to issue server requests and download data. The purpose is to make the most up-to-date content visible the instant the user brings up an app. In an ideal world, background fetch would kill off the “Loading…” screen that server-driven apps typically present when launched. Background fetch is particularly well-suited for us at Gilt, because we feature a new slate of sales every day. Each day brings updated sale data and new photos to send to the user. Before iOS added support for background fetch, a user would launch the Gilt app (or bring it to the foreground after a certain period of time), and we’d start a flurry of communication with the server that would eventually result in the sales list and associated photos being loaded; the user’s cart and other settings would also get synced. On slow network connections, this process could take a while—costing our users precious time while they raced against other customers before the items in the day’s flash sales sold out. An Unexpected Complication We introduced background fetch in our Gilt for iPhone 4.0 release. Immediately the benefits became apparent: users could access sales much more quickly than before, and they also spent less time in loading-screen limbo. We patted ourselves on the back for a job well done. And then we started to receive bug reports. Users who had logged in and left the “Stay Signed In” option turned on began to report trouble. A day or two (or three) after signing in, these users would suddenly be logged out. They’d sign in again, only to be booted out again within the next few days. Weird. Although we had not seen this issue during our QA testing, we eventually started noticing it on our personal devices. But we could never pin down exactly what we were doing to cause it. As any developer will tell you, repeatable steps to reproduce—the actions a user needs to perform to hit a bug—are critical in diagnosing and fixing problems. After all, how can you be sure you’ve fixed a bug if you don’t know how to trigger it in the first place? We didn’t have steps to reproduce, so we scoured our codebase and tried a number of speculative fixes. We created new test binaries and distributed them to our QA team and internal users. And then we waited a few days to see if everyone who signed in still was. Soon enough, we got the verdict: the bug remained alive. So we’d repeat the cycle again. A LaGuardia Eureka In the middle of all this, I was about to depart on a long-planned vacation. While waiting to board a plane at LaGuardia, I fired up the Delta app to retrieve my boarding pass. Despite having just logged in a few minutes earlier, I noticed that I was being asked to log in again. I had used the Delta app under iOS 6, so I knew the normal behavior was to keep me logged in. I logged in again, and as a test, put the app in the background. A few minutes later, I returned, and again I was logged out. I tried a few other apps, and noticed that Gilt and Delta weren’t the only apps bitten by the user logout bug. Going on vacation gave me a reason to use the Delta app, which in turn provided the Eureka moment that pointed me in a different direction. Gilt’s mobile team had been working under the assumption that the user logout issue was specific to our app. But now the problem appeared to be widespread—a hunch confirmed by The Verge’s Ellis Hamburger—and this gave us a starting point for researching the problem. When iOS 7 became available, the nuances of background fetch weren’t immediately obvious to developers. There was a temptation to approach this new feature with the attitude: Great! I’ll just take the network requests my app makes at launch, and put them in a background fetch wrapper. How easy is that? Not that easy, it turns out. Because background fetch changes the environment in which an app’s networking code executes, the same code won’t necessarily behave the same way when running in the background. The Source of Our Trouble In the case of the user logout bug, the problem was that the iOS Keychain wasn’t consistently available when we’d try to access it. The Keychain is the recommended place for storing sensitive information like usernames and passwords. When data is put in the Keychain, iOS ensures that it is stored securely. By default, when running on phones with a lock code, secure Keychain items remain encrypted while the lock screen is on; they only become available after the owner enters the correct code—or successfully scans a fingerprint—to unlock the device. This ensures that someone gaining physical access to your phone can’t perform a basic forensic analysis to extract sensitive data from your Keychain. Before background fetch, most apps could assume that their secure Keychain items would be available whenever they were needed, because most apps didn’t expect to be performing routine operations—much less be running—when the lock screen was on. However, with background fetch, it is now possible for an app to wake up while the device is locked, when its Keychain items aren’t available. The Gilt app periodically re-authenticates with the server and syncs the items in the user’s cart. This ensures a seamless cross-device experience for our users. However, it was also the source of our user logout bug, because our authentication requests would sometimes get issued in the background when the device was locked. In such a case, the Gilt app would dutifully ask the Keychain for the user’s credentials. But because the device was locked, the Keychain would return a null value, causing the app to behave as though there were no user credentials at all. As far as the app is concerned, no credentials == no user, so the next time the user began interacting with the app, they’d no longer be logged in. We never caught this problem in our internal QA testing, because we didn’t have lock codes on our test devices. Don’t Decrease Default Security After discovering that Keychain access was the source of the issue, we sought to find out how other developers approached solving it. One popular suggestion is to store items in the Keychain with the kSecAttrAccessible attribute set to kSecAttrAccessibleAlways. Unfortunately, this requires using a less secure mechanism for storing data than the Keychain would otherwise use by default. If the only way for your app to function correctly during a background fetch depends on loosening security settings, you should seriously consider refactoring your code. The kSecAttrAccessibleAlways setting allows data to remain unencrypted while the device is locked. The stored data will not be secure if someone manages to gain physical access to your device. At Gilt, we need to be extremely careful about how we handle sensitive data. If we’re going to explicitly change a default security setting, we’re going to tighten that setting, not loosen it. Instead of reducing the security of what we store in the Keychain, we changed our request model to ensure that authentication never needs to be done in the background. If the Keychain isn’t available, we simply won’t try to authenticate. This solution addresses only half the problem, though. In an ideal world, we’d still be able to authenticate and sync the cart sometime before—or at least when—the app becomes active, to ensure that the user always sees the current cart items. If the device is locked, we need to be notified when the Keychain becomes available again, so we’ll know when it is safe to build the necessary server requests. Knowing When the Keychain is Ready The key is hooking into the UIApplicationDelegate&rsquo;s applicationProtectedDataDidBecomeAvailable: method. iOS calls this method after the device has become unlocked, so it serves as a signal that we can now get the user’s authentication credentials from the Keychain. This method can be called before the app is brought to the foreground, letting us get a head start with the cart sync. Although rethinking our server requests for a background fetch world required a little more work, we avoided undermining iOS’s default security settings. And since we rolled out this change in our recent Gilt for iPhone 4.0.2 release, we’ve received no more user reports about this problem. The moral of the story? When faced with a seemingly intractable problem, take a vacation. You might find inspiration in unexpected ways." />
<link rel="canonical" href="https://tech.hbc.com/2013-11-24-sleuthing-and-solving-the-user-logout-bug-on-ios.html" />
<meta property="og:url" content="https://tech.hbc.com/2013-11-24-sleuthing-and-solving-the-user-logout-bug-on-ios.html" />
<meta property="og:site_name" content="HBC Tech" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2013-11-24T08:05:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@" />
<meta name="twitter:creator" content="@HBC Tech" />
<script type="application/ld+json">
{"description":"iOS 7 brought many new features, and much new work for developers. One of the features the Gilt mobile team was most excited about was background fetch. With background fetch, apps that are running in the background—or not even running at all—can wake up periodically to issue server requests and download data. The purpose is to make the most up-to-date content visible the instant the user brings up an app. In an ideal world, background fetch would kill off the “Loading…” screen that server-driven apps typically present when launched. Background fetch is particularly well-suited for us at Gilt, because we feature a new slate of sales every day. Each day brings updated sale data and new photos to send to the user. Before iOS added support for background fetch, a user would launch the Gilt app (or bring it to the foreground after a certain period of time), and we’d start a flurry of communication with the server that would eventually result in the sales list and associated photos being loaded; the user’s cart and other settings would also get synced. On slow network connections, this process could take a while—costing our users precious time while they raced against other customers before the items in the day’s flash sales sold out. An Unexpected Complication We introduced background fetch in our Gilt for iPhone 4.0 release. Immediately the benefits became apparent: users could access sales much more quickly than before, and they also spent less time in loading-screen limbo. We patted ourselves on the back for a job well done. And then we started to receive bug reports. Users who had logged in and left the “Stay Signed In” option turned on began to report trouble. A day or two (or three) after signing in, these users would suddenly be logged out. They’d sign in again, only to be booted out again within the next few days. Weird. Although we had not seen this issue during our QA testing, we eventually started noticing it on our personal devices. But we could never pin down exactly what we were doing to cause it. As any developer will tell you, repeatable steps to reproduce—the actions a user needs to perform to hit a bug—are critical in diagnosing and fixing problems. After all, how can you be sure you’ve fixed a bug if you don’t know how to trigger it in the first place? We didn’t have steps to reproduce, so we scoured our codebase and tried a number of speculative fixes. We created new test binaries and distributed them to our QA team and internal users. And then we waited a few days to see if everyone who signed in still was. Soon enough, we got the verdict: the bug remained alive. So we’d repeat the cycle again. A LaGuardia Eureka In the middle of all this, I was about to depart on a long-planned vacation. While waiting to board a plane at LaGuardia, I fired up the Delta app to retrieve my boarding pass. Despite having just logged in a few minutes earlier, I noticed that I was being asked to log in again. I had used the Delta app under iOS 6, so I knew the normal behavior was to keep me logged in. I logged in again, and as a test, put the app in the background. A few minutes later, I returned, and again I was logged out. I tried a few other apps, and noticed that Gilt and Delta weren’t the only apps bitten by the user logout bug. Going on vacation gave me a reason to use the Delta app, which in turn provided the Eureka moment that pointed me in a different direction. Gilt’s mobile team had been working under the assumption that the user logout issue was specific to our app. But now the problem appeared to be widespread—a hunch confirmed by The Verge’s Ellis Hamburger—and this gave us a starting point for researching the problem. When iOS 7 became available, the nuances of background fetch weren’t immediately obvious to developers. There was a temptation to approach this new feature with the attitude: Great! I’ll just take the network requests my app makes at launch, and put them in a background fetch wrapper. How easy is that? Not that easy, it turns out. Because background fetch changes the environment in which an app’s networking code executes, the same code won’t necessarily behave the same way when running in the background. The Source of Our Trouble In the case of the user logout bug, the problem was that the iOS Keychain wasn’t consistently available when we’d try to access it. The Keychain is the recommended place for storing sensitive information like usernames and passwords. When data is put in the Keychain, iOS ensures that it is stored securely. By default, when running on phones with a lock code, secure Keychain items remain encrypted while the lock screen is on; they only become available after the owner enters the correct code—or successfully scans a fingerprint—to unlock the device. This ensures that someone gaining physical access to your phone can’t perform a basic forensic analysis to extract sensitive data from your Keychain. Before background fetch, most apps could assume that their secure Keychain items would be available whenever they were needed, because most apps didn’t expect to be performing routine operations—much less be running—when the lock screen was on. However, with background fetch, it is now possible for an app to wake up while the device is locked, when its Keychain items aren’t available. The Gilt app periodically re-authenticates with the server and syncs the items in the user’s cart. This ensures a seamless cross-device experience for our users. However, it was also the source of our user logout bug, because our authentication requests would sometimes get issued in the background when the device was locked. In such a case, the Gilt app would dutifully ask the Keychain for the user’s credentials. But because the device was locked, the Keychain would return a null value, causing the app to behave as though there were no user credentials at all. As far as the app is concerned, no credentials == no user, so the next time the user began interacting with the app, they’d no longer be logged in. We never caught this problem in our internal QA testing, because we didn’t have lock codes on our test devices. Don’t Decrease Default Security After discovering that Keychain access was the source of the issue, we sought to find out how other developers approached solving it. One popular suggestion is to store items in the Keychain with the kSecAttrAccessible attribute set to kSecAttrAccessibleAlways. Unfortunately, this requires using a less secure mechanism for storing data than the Keychain would otherwise use by default. If the only way for your app to function correctly during a background fetch depends on loosening security settings, you should seriously consider refactoring your code. The kSecAttrAccessibleAlways setting allows data to remain unencrypted while the device is locked. The stored data will not be secure if someone manages to gain physical access to your device. At Gilt, we need to be extremely careful about how we handle sensitive data. If we’re going to explicitly change a default security setting, we’re going to tighten that setting, not loosen it. Instead of reducing the security of what we store in the Keychain, we changed our request model to ensure that authentication never needs to be done in the background. If the Keychain isn’t available, we simply won’t try to authenticate. This solution addresses only half the problem, though. In an ideal world, we’d still be able to authenticate and sync the cart sometime before—or at least when—the app becomes active, to ensure that the user always sees the current cart items. If the device is locked, we need to be notified when the Keychain becomes available again, so we’ll know when it is safe to build the necessary server requests. Knowing When the Keychain is Ready The key is hooking into the UIApplicationDelegate&rsquo;s applicationProtectedDataDidBecomeAvailable: method. iOS calls this method after the device has become unlocked, so it serves as a signal that we can now get the user’s authentication credentials from the Keychain. This method can be called before the app is brought to the foreground, letting us get a head start with the cart sync. Although rethinking our server requests for a background fetch world required a little more work, we avoided undermining iOS’s default security settings. And since we rolled out this change in our recent Gilt for iPhone 4.0.2 release, we’ve received no more user reports about this problem. The moral of the story? When faced with a seemingly intractable problem, take a vacation. You might find inspiration in unexpected ways.","author":{"@type":"Person","name":"HBC Tech"},"@type":"BlogPosting","url":"https://tech.hbc.com/2013-11-24-sleuthing-and-solving-the-user-logout-bug-on-ios.html","headline":"Sleuthing–and Solving–the User Logout Bug on iOS 7","dateModified":"2013-11-24T08:05:00-05:00","datePublished":"2013-11-24T08:05:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://tech.hbc.com/2013-11-24-sleuthing-and-solving-the-user-logout-bug-on-ios.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

        <meta property="og:title" content="Sleuthing--and Solving--the User Logout Bug on iOS 7" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://tech.hbc.com//2013-11-24-sleuthing-and-solving-the-user-logout-bug-on-ios.html" />
<meta property="og:description" content="iOS 7 brought many new features, and much new work for developers. One of the features the Gilt mobile team was most excited about was background fetch. With..." />
<meta property="og:image" content="https://tech.hbc.com/assets/images/blog/hbc-tech-logo-tipi.jpg" />
<meta property="og:image:secure_url" content="https://tech.hbc.com/assets/images/" />
<meta property="og:image:type" content="image/jpeg" />
<meta property="og:image:alt" content="" />


        <link rel="stylesheet" href="https://tech.hbc.com/assets/css/main.css">
        <link rel="canonical" href="https://tech.hbc.com/2013-11-24-sleuthing-and-solving-the-user-logout-bug-on-ios.html">
        <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,700" rel="stylesheet">

        <!-- Icons -->
        <!-- 16x16 -->
        <link rel="shortcut icon" href="https://tech.hbc.com/assets/images/favicon.ico">
    </head>

    <body aria-label="Content">
        <header id="site-header" class="site-header">
    <div class="site-header__inner">
    	<a class="site-header__logo" href="/">
        	<svg class="hbc-tech-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 52">
        		<use class="hbc-tech-logo__text" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/assets/images/hbc-icons.svg#hbc-tech-logo"></use>
            </svg>
    	</a>
        <nav id="menu" class="navigation">
    <svg class="navigation__menu-icon" xmlns="http://www.w3.org/2000/svg">
        <path class="bar bar__top" d="M0,3 L30,3" />
        <path class="bar bar__cross-1" d="M0,14 L30,14" />
        <path class="bar bar__cross-2" d="M0,14 L30,14" />
        <path class="bar bar__bottom" d="M0,25 L30,25" />
    </svg>
	<menu class="menu">
		<ul class="link-list">
		
        
            <li class="link-list__link-item">
                <a href="https://tech.hbc.com/" class="link-list__link
            
            ">
                <span class="link-list__link-highlight">Insights</span></a>
            </li>
        
            <li class="link-list__link-item">
                <a href="https://tech.hbc.com/code" class="link-list__link
            
            ">
                <span class="link-list__link-highlight">Code</span></a>
            </li>
        
            <li class="link-list__link-item">
                <a href="https://tech.hbc.com/about" class="link-list__link
            
            ">
                <span class="link-list__link-highlight">About</span></a>
            </li>
        
            <li class="link-list__link-item">
                <a href="https://tech.hbc.com/work-here" class="link-list__link
            
            ">
                <span class="link-list__link-highlight">Work Here</span></a>
            </li>
        
	    </ul>
	</menu>
</nav>

        <search id="header-search" class="header-search">
	<form class="header-search__form" action>
	  <input type="text" class="header-search__input" id="header-search-input" placeholder=" Search" name="query">
	</form>
  	<svg id="header-search__toggle" class="header-search__svg" xmlns="http://www.w3.org/2000/svg" >
		<path id="leftSearch" class="path path--left-half" d="M11.4842576,23.9891168 C5.09608476,23.7189967 0,18.4546255 0,12 C0,5.54951437 4.85419801,0.113423154 12.4763811,0.0114091479"/>
		<path id="rightSearch" class="path path--right-half" d="M12.5376167,0.0118279089 C18.9155446,0.293025077 24,5.55274344 24,12 C24,18.4701834 17.7604297,24.3112218 11.1896721,23.9909829"/>
		<path id="handle" class="path path--handle" d="M20.7485408,20.8914207 L26.8571202,27 L20.7485408,20.8914207"/>
    </svg>
    <section class="header-search__results" id="header-search__results"></section>
</search>

    </div>
</header>

        <section class="content"><article class="article">
    <header class="article__header article__header--reveal">
        <h1 class="header-title" title="Sleuthing--and Solving--the User Logout Bug on iOS 7">Sleuthing--and Solving--the User Logout Bug on iOS 7</h1>
        
        <span id="no-image-placeholder" class="no-image-placeholder"></span>
        

        
        
        
            <span class="slug-divider"></span>
            <span class="article-meta__author">
            
                
                <!-- if author exists in site.authors, create link to author's page -->
                
                    
                
                    
                
                    
                
                    
                
                    
                    <a class="article-meta__author__link" href="https://tech.hbc.com/authors/hbc-tech">
                    
                
                    
                
                <!-- render the author name regardless if they're a featured author -->HBC Tech<!-- if author exists in site.authors, close link to author's page -->
                <!-- add author's job title to give article more clout -->
                
                    
                
                    
                
                    
                
                    
                
                    
                    </a>
                    
                
                    
                
            
            </span>
            <span class="slug-divider"></span>
        
    
            <span class="article-meta__date">
                NOV 24, 2013
            </span>
        </div>
    </header>
    <section class="article__content article__content--reveal">
        
        <div class="article__content__read-time"><span class="read-time" title="Estimated read time">
  
  
    <span class="read-time__text-1">8 min</span>
    <span class="read-time__text-2">Read</span>
    <span class="read-time__text-3">Time</span>
  
</span>
</div>
        <div class="article__content__share-buttons"><ul class="share-buttons">
    <li class="share-buttons__link-item">
        <a href="https://twitter.com/intent/tweet?text=https://tech.hbc.com//2013-11-24-sleuthing-and-solving-the-user-logout-bug-on-ios.html" class="share-buttons__link" title="Share on Twitter" target="_blank">
            <svg class="hbc-svg-icon" height="36" width="36" xmlns="http://www.w3.org/2000/svg">
                <use class="hbc-svg-icon--twitter" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/assets/images/hbc-icons.svg#twitter"></use>
            </svg>
        </a>
    </li>
    <li class="share-buttons__link-item">
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://tech.hbc.com/&source=/2013-11-24-sleuthing-and-solving-the-user-logout-bug-on-ios.html&title=Sleuthing--and Solving--the User Logout Bug on iOS 7" class="share-buttons__link" title="Share on Linkedin" target="_blank">
            <svg height="36" width="36" xmlns="http://www.w3.org/2000/svg">
                <use class="hbc-svg-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/assets/images/hbc-icons.svg#linkedin" ></use>
            </svg>
        </a>
    </li>
    <li class="share-buttons__link-item">
        <a href="https://www.facebook.com/sharer/sharer.php?u=https://tech.hbc.com//2013-11-24-sleuthing-and-solving-the-user-logout-bug-on-ios.html" class="share-buttons__link" title="Share on Facebook" target="_blank">
            <svg height="36" width="36" xmlns="http://www.w3.org/2000/svg">
                <use class="hbc-svg-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/assets/images/hbc-icons.svg#facebook" ></use>
            </svg>
        </a>
    </li>
    <li class="share-buttons__link-item">
        <a href="https://www.reddit.com/submit?url=https://tech.hbc.com//2013-11-24-sleuthing-and-solving-the-user-logout-bug-on-ios.html" class="share-buttons__link" title="Share on Reddit" target="_blank">
            <svg height="36" width="36" xmlns="http://www.w3.org/2000/svg">
                <use class="hbc-svg-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/assets/images/hbc-icons.svg#reddit" ></use>
            </svg>
        </a>
    </li>
</ul>
</div>
        <div class="article__content__body"><p><img alt="image" src="http://media.tumblr.com/0c3af4f712d176875304c821df74ba5f/tumblr_inline_mwoeg7hbWI1s17bu5.png"/></p>
<p>iOS 7 brought many <a href="http://reviews.cnet.com/apple-ios-7/" target="_blank">new features</a>, and much new work for developers.</p>
<p>One of the features the Gilt mobile team was most excited about was <strong>background fetch</strong>. With background fetch, apps that are running in the background—or not even running at all—can wake up periodically to issue server requests and download data. The purpose is to make the most up-to-date content visible the instant the user brings up an app. In an ideal world, background fetch would kill off the “Loading…” screen that server-driven apps typically present when launched.</p>
<p>Background fetch is particularly well-suited for us at Gilt, because we feature a new slate of sales every day. Each day brings updated sale data and new photos to send to the user.</p>
<p>Before iOS added support for background fetch, a user would launch <a href="http://www.gilt.com/apps/iphone" target="_blank">the Gilt app</a> (or bring it to the foreground after a certain period of time), and we’d start a flurry of communication with the server that would eventually result in the sales list and associated photos being loaded; the user’s cart and other settings would also get synced. On slow network connections, this process could take a while—costing our users precious time while they raced against other customers before the items in the day’s flash sales sold out.</p>
<p><br/><strong>An Unexpected Complication</strong></p>
<p>We introduced background fetch in our Gilt for iPhone 4.0 release. Immediately the benefits became apparent: users could access sales much more quickly than before, and they also spent less time in loading-screen limbo. We patted ourselves on the back for a job well done.</p>
<p>And then we started to receive bug reports. Users who had logged in and left the “Stay Signed In” option turned on began to report trouble. A day or two (or three) after signing in, these users would suddenly be logged out. They’d sign in again, only to be booted out again within the next few days.</p>
<p>Weird.</p>
<p>Although we had not seen this issue during our QA testing, we eventually started noticing it on our personal devices. But we could never pin down exactly what we were doing to cause it.</p>
<p>As any developer will tell you, repeatable <em>steps to reproduce</em>—the actions a user needs to perform to hit a bug—are critical in diagnosing and fixing problems. After all, how can you be sure you’ve fixed a bug if you don’t know how to trigger it in the first place?</p>
<p>We didn’t have steps to reproduce, so we scoured our codebase and tried a number of speculative fixes. We created new test binaries and distributed them to our QA team and internal users. And then we waited a few days to see if everyone who signed in still was. Soon enough, we got the verdict: the bug remained alive.</p>
<p>So we’d repeat the cycle again.</p>
<p><br/><strong>A LaGuardia Eureka</strong></p>
<p>In the middle of all this, I was about to depart on a long-planned vacation. While waiting to board a plane at LaGuardia, I fired up the Delta app to retrieve my boarding pass. Despite having just logged in a few minutes earlier, I noticed that I was being asked to log in again. I had used the Delta app under iOS 6, so I knew the normal behavior was to keep me logged in.</p>
<p>I logged in again, and as a test, put the app in the background. A few minutes later, I returned, and again I was logged out. I tried a few other apps, and noticed that Gilt and Delta weren’t the only apps bitten by the user logout bug.</p>
<p>Going on vacation gave me a reason to use the Delta app, which in turn provided the Eureka moment that pointed me in a different direction. Gilt’s mobile team had been working under the assumption that the user logout issue was specific to our app. But now the problem appeared to be widespread—a hunch confirmed by <a href="http://www.theverge.com/2013/9/23/4761860/ios-7-bug-snapchat-mailbox-loom-logged-out" target="_blank"><em>The Verge</em>’s Ellis Hamburger</a>—and this gave us a starting point for researching the problem.</p>
<p>When iOS 7 became available, the nuances of background fetch weren’t immediately obvious to developers. There was a temptation to approach this new feature with the attitude: <em>Great! I’ll just take the network requests my app makes at launch, and put them in a background fetch wrapper. How easy is that?</em></p>
<p>Not that easy, it turns out. Because background fetch changes the environment in which an app’s networking code executes, the same code won’t necessarily behave the same way when running in the background.</p>
<p><br/><strong>The Source of Our Trouble</strong></p>
<p>In the case of the user logout bug, the problem was that the iOS Keychain wasn’t consistently available when we’d try to access it.</p>
<p>The Keychain is the recommended place for storing sensitive information like usernames and passwords. When data is put in the Keychain, iOS ensures that it is stored securely. By default, when running on phones with a lock code, secure Keychain items remain encrypted while the lock screen is on; they only become available after the owner enters the correct code—or successfully scans a fingerprint—to unlock the device. This ensures that someone gaining physical access to your phone can’t perform a basic forensic analysis to extract sensitive data from your Keychain.</p>
<p>Before background fetch, most apps could assume that their secure Keychain items would be available whenever they were needed, because most apps didn’t expect to be performing routine operations—much less <em>be</em> <em>running</em>—when the lock screen was on. However, with background fetch, it is now possible for an app to wake up while the device is locked, when its Keychain items aren’t available.</p>
<p>The Gilt app periodically re-authenticates with the server and syncs the items in the user’s cart. This ensures a seamless cross-device experience for our users. However, it was also the source of our user logout bug, because our authentication requests would sometimes get issued in the background when the device was locked.</p>
<p>In such a case, the Gilt app would dutifully ask the Keychain for the user’s credentials. But because the device was locked, the Keychain would return a null value, causing the app to behave as though there were no user credentials at all. As far as the app is concerned, no credentials == no user, so the next time the user began interacting with the app, they’d no longer be logged in.</p>
<p>We never caught this problem in our internal QA testing, because we didn’t have lock codes on our test devices.</p>
<p><br/><strong>Don’t Decrease Default Security</strong></p>
<p>After discovering that Keychain access was the source of the issue, we sought to find out how other developers approached solving it. <a href="http://stackoverflow.com/questions/10536859/ios-keychain-not-retrieving-values-from-background/10583042#10583042" target="_blank">One popular suggestion</a> is to store items in the Keychain with the <code>kSecAttrAccessible</code> attribute set to <code>kSecAttrAccessibleAlways</code>. Unfortunately, this requires using a less secure mechanism for storing data than the Keychain would otherwise use by default.</p>
<p>If the only way for your app to function correctly during a background fetch depends on loosening security settings, <strong>you should seriously consider refactoring your code.</strong> The <code>kSecAttrAccessibleAlways</code> setting allows data to remain unencrypted while the device is locked. The stored data will not be secure if someone manages to gain physical access to your device. At Gilt, we need to be extremely careful about how we handle sensitive data. If we’re going to explicitly change a default security setting, we’re going to tighten that setting, not loosen it.</p>
<p>Instead of reducing the security of what we store in the Keychain, we changed our request model to ensure that authentication never <em>needs</em> to be done in the background. If the Keychain isn’t available, we simply won’t try to authenticate.</p>
<p>This solution addresses only half the problem, though. In an ideal world, we’d still be able to authenticate and sync the cart sometime <em>before</em>—or at least <em>when</em>—the app becomes active, to ensure that the user always sees the current cart items. If the device is locked, we need to be notified when the Keychain becomes available again, so we’ll know when it is safe to build the necessary server requests.</p>
<p><br/><strong>Knowing When the Keychain is Ready</strong></p>
<p>The key is hooking into the <code>UIApplicationDelegate</code>&rsquo;s <code>applicationProtectedDataDidBecomeAvailable:</code> method.</p>
<p>iOS calls this method after the device has become unlocked, so it serves as a signal that we can now get the user’s authentication credentials from the Keychain. This method can be called before the app is brought to the foreground, letting us get a head start with the cart sync.</p>
<p>Although rethinking our server requests for a background fetch world required a little more work, we avoided undermining iOS’s default security settings.</p>
<p>And since we rolled out this change in our recent Gilt for iPhone 4.0.2 release, we’ve received no more user reports about this problem.</p>
<p>The moral of the story?</p>
<p>When faced with a seemingly intractable problem, take a vacation. You might find inspiration in unexpected ways.</p>
</div>
        <footer class="article__content__footer">
            
<div class="article-tags">

    <span class="article-tags__tag">Evan Maloney</span><span>,</span>
    

    <span class="article-tags__tag">ios7</span><span>,</span>
    

    <span class="article-tags__tag">iOS 7</span><span>,</span>
    

    <span class="article-tags__tag">iOS Development</span><span>,</span>
    

    <span class="article-tags__tag">user logout bug</span><span>,</span>
    

    <span class="article-tags__tag">background fetch</span><span>,</span>
    

    <span class="article-tags__tag">Gilt app</span><span>,</span>
    

    <span class="article-tags__tag">data</span><span>,</span>
    

    <span class="article-tags__tag">customer experience</span><span>,</span>
    

    <span class="article-tags__tag">user experience</span><span>,</span>
    

    <span class="article-tags__tag">bugs</span><span>,</span>
    

    <span class="article-tags__tag">Eureka moments</span><span>,</span>
    

    <span class="article-tags__tag">Delta app</span><span>,</span>
    

    <span class="article-tags__tag">The Verge</span><span>,</span>
    

    <span class="article-tags__tag">Ellis Hamburger</span><span>,</span>
    

    <span class="article-tags__tag">iOS Keychain</span><span>,</span>
    

    <span class="article-tags__tag">infosec</span><span>,</span>
    

    <span class="article-tags__tag">default security</span><span>,</span>
    

    <span class="article-tags__tag">kSecAttrAccessible</span><span>,</span>
    

    <span class="article-tags__tag">kSecAttrAccessibleAlways</span><span>,</span>
    

    <span class="article-tags__tag">authentication</span><span>,</span>
    

    <span class="article-tags__tag">UIApplicationDelegate</span><span>,</span>
    

    <span class="article-tags__tag">applicationProtectedDataDidBecomeAvailable:</span><span>,</span>
    

    <span class="article-tags__tag">Gilt for iPhone 4.0.2</span><span>,</span>
    

    <span class="article-tags__tag">Evan Coyne Maloney</span>

</div>


            <!-- author bio -->
<section class="author-bio">


	

	
	<!-- author is a known contributor -->
		
		<svg class="author-bio__avatar" height="36" width="36" xmlns="http://www.w3.org/2000/svg">
	        <use class="hbc-svg-icon hbc-svg-icon--avatar__circle" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/assets/images/hbc-icons.svg#circle" ></use>
	        <use class="hbc-svg-icon hbc-svg-icon--avatar__head" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/assets/images/hbc-icons.svg#head" ></use>
	        <use class="hbc-svg-icon hbc-svg-icon--avatar__body" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/assets/images/hbc-icons.svg#body" ></use>
	    </svg>
		

		
		<p><a class="author-bio__link" href="https://tech.hbc.com/authors/hbc-tech">HBC Tech</a>

		
		<p class="author-bio__bio">We power the website and mobile experiences for Saks,  Saks Off Fifth, Gilt, Lord & Taylor and The Bay.
</p>
		

	


</section>

        </footer>
    </section>
    <aside class="recirc">
    <h2 class="header__title">Recent Insights</h2><span class="slug-divider"></span>
    <a class="header__view-all-link" href="https://tech.hbc.com/categories/index.html">See All</a>
    <div class="recirc__articles">
    
    
    
    
    
    

    
        
            
        <article class="recirc__articles__item">
            


<section class="snippet">
    
    
    <h1 class="snippet__title">
    <a href="https://tech.hbc.com/2017-12-30-presentations-we-love.html" class="snippet__title__link" title="Presentations we love: 2017">
        Presentations we love: 2017
    </a>
    </h1>
    <div class="snippet__meta">
    
        
        
        
            

            
                <a class="meta__category-link" href="https://tech.hbc.com/categories/#presentations">presentations</a>
            
            
            <span class="slug-divider"></span>
        
    

    
        
            <span class="meta__author">
            
                
                <!-- if author exists in site.authors, create link to author's page -->
                
                    
                
                    
                
                    
                
                    
                
                    
                    <a class="meta__author-link" href="https://tech.hbc.com/authors/hbc-tech">
                    
                
                    
                
                <!-- render the author name regardless if they're a featured author -->HBC Tech<!-- if author exists in site.authors, close link to author's page -->
                <!-- add author's job title to give article more clout -->
                
                    
                
                    
                
                    
                
                    
                
                    
                    </a>
                    
                
                    
                
            
            </span>
            <span class="slug-divider"></span>
        
    
    
        <span class="meta__date">DEC 30, 2017</span>
    
    </div>
    
        <a href="https://tech.hbc.com/2017-12-30-presentations-we-love.html" class="snippet__excerpt__link" title="Presentations we love: 2017">
            <p class="snippet__excerpt">
            2017 was a year of growth and learning at HBC Tech. Our organization embraced new technologies and new ways of building application software.


            </p>
        </a>
    
</section>

        </article>
        
    
        
            
        <article class="recirc__articles__item">
            


<section class="snippet">
    
    
    <h1 class="snippet__title">
    <a href="https://tech.hbc.com/2017-08-10-midyear-recap.html" class="snippet__title__link" title="HBC Tech Talks: February 2017 through July 2017">
        HBC Tech Talks: February 2017 through July 2017
    </a>
    </h1>
    <div class="snippet__meta">
    
        
        
        
            

            
                <a class="meta__category-link" href="https://tech.hbc.com/category/events">events</a>
            
            
            <span class="slug-divider"></span>
        
    

    
        
            <span class="meta__author">
            
                
                <!-- if author exists in site.authors, create link to author's page -->
                
                    
                
                    
                
                    
                
                    
                
                    
                    <a class="meta__author-link" href="https://tech.hbc.com/authors/hbc-tech">
                    
                
                    
                
                <!-- render the author name regardless if they're a featured author -->HBC Tech<!-- if author exists in site.authors, close link to author's page -->
                <!-- add author's job title to give article more clout -->
                
                    
                
                    
                
                    
                
                    
                
                    
                    </a>
                    
                
                    
                
            
            </span>
            <span class="slug-divider"></span>
        
    
    
        <span class="meta__date">AUG 10, 2017</span>
    
    </div>
    
        <a href="https://tech.hbc.com/2017-08-10-midyear-recap.html" class="snippet__excerpt__link" title="HBC Tech Talks: February 2017 through July 2017">
            <p class="snippet__excerpt">
            We’ve had a busy 2017 at HBC. The great work of our teams has created opportunities to share what we’ve learned with audiences around the world. This year our folks have been on stage in Austin, Sydney, Portland, Seattle, San Diego, Boston, London, Israel and on our home turf in NYC and Dublin. The talks have covered deep learning, design thinking, data streaming and developer experience to name just a...
            </p>
        </a>
    
</section>

        </article>
        
    
        
            
        <article class="recirc__articles__item">
            


<section class="snippet">
    
    
    <h1 class="snippet__title">
    <a href="https://tech.hbc.com/2017-06-29-open-source-friday.html" class="snippet__title__link" title="Open Source Friday">
        Open Source Friday
    </a>
    </h1>
    <div class="snippet__meta">
    
        
        
        
            

            
                <a class="meta__category-link" href="https://tech.hbc.com/category/culture">culture</a>
            
            
            <span class="slug-divider"></span>
        
    

    
        
            <span class="meta__author">
            
                
                <!-- if author exists in site.authors, create link to author's page -->
                
                    
                
                    
                
                    
                
                    
                
                    
                    <a class="meta__author-link" href="https://tech.hbc.com/authors/hbc-tech">
                    
                
                    
                
                <!-- render the author name regardless if they're a featured author -->HBC Tech<!-- if author exists in site.authors, close link to author's page -->
                <!-- add author's job title to give article more clout -->
                
                    
                
                    
                
                    
                
                    
                
                    
                    </a>
                    
                
                    
                
            
            </span>
            <span class="slug-divider"></span>
        
    
    
        <span class="meta__date">JUN 29, 2017</span>
    
    </div>
    
        <a href="https://tech.hbc.com/2017-06-29-open-source-friday.html" class="snippet__excerpt__link" title="Open Source Friday">
            <p class="snippet__excerpt">
            
From the 54 public repos maintained at code.gilt.com to the name of our tech blog (displayed in this tab’s header), open source has been part of our team’s DNA for years. Check out this blog post from 2015 if you’re not convinced.



            </p>
        </a>
    
</section>

        </article>
        
    
        
            
        <article class="recirc__articles__item">
            


<section class="snippet">
    
    
    <h1 class="snippet__title">
    <a href="https://tech.hbc.com/2017-06-12-hbc-at-qcon.html" class="snippet__title__link" title="Hudson's Bay Company at QCon">
        Hudson's Bay Company at QCon
    </a>
    </h1>
    <div class="snippet__meta">
    
        
        
        
            

            
                <a class="meta__category-link" href="https://tech.hbc.com/category/events">events</a>
            
            
            <span class="slug-divider"></span>
        
    

    
        
            <span class="meta__author">
            
                
                <!-- if author exists in site.authors, create link to author's page -->
                
                    
                
                    
                
                    
                
                    
                
                    
                    <a class="meta__author-link" href="https://tech.hbc.com/authors/hbc-tech">
                    
                
                    
                
                <!-- render the author name regardless if they're a featured author -->HBC Tech<!-- if author exists in site.authors, close link to author's page -->
                <!-- add author's job title to give article more clout -->
                
                    
                
                    
                
                    
                
                    
                
                    
                    </a>
                    
                
                    
                
            
            </span>
            <span class="slug-divider"></span>
        
    
    
        <span class="meta__date">JUN 12, 2017</span>
    
    </div>
    
        <a href="https://tech.hbc.com/2017-06-12-hbc-at-qcon.html" class="snippet__excerpt__link" title="Hudson's Bay Company at QCon">
            <p class="snippet__excerpt">
            Heading to QCon? Don’t miss these two sessions! If you can’t make it, stay tuned here for slides and recordings from the conference.


            </p>
        </a>
    
</section>

        </article>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
    </div>
</aside>

</article>

</section>
        <footer class="footer">
	<svg class="est1670" xmlns="http://www.w3.org/2000/svg">
		<use class="hbc-tech-logo__use" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/assets/images/hbc-icons.svg#est1670" ></use>
	</svg>
    <section class="footer__links">
	<ul class="social-links social-links__list">
    <li class="social-links__list-item">
        <a class="social-links__link" target="_blank" rel="next" href="https://www.linkedin.com/company/hbc_digital/">
            <svg class="social-links__icon" xmlns="http://www.w3.org/2000/svg">
                <use class="linkedin"  xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/assets/images/hbc-icons.svg#linkedin"></use>
            </svg>
        </a>
    </li>
    <li class="social-links__list-item">
        <a class="social-links__link" target="_blank" rel="next" href="https://twitter.com/hbcdigital/">
            <svg class="social-links__icon" xmlns="http://www.w3.org/2000/svg">
                <use class="twitter"  xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/assets/images/hbc-icons.svg#twitter"></use>
            </svg>
        </a>
    </li>
    <li class="social-links__list-item">
        <a class="social-links__link" target="_blank" rel="next" href="https://www.instagram.com/hbcdigital">
            <svg class="social-links__icon" xmlns="http://www.w3.org/2000/svg">
                <use class="instagram"  xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tech.hbc.com/assets/images/hbc-icons.svg#instagram"></use>
            </svg>
        </a>
    </li>
</ul>

	<p class="copyright">&copy; 2018 HBC Tech</i></p>
	</section>
</footer>

        <script type="text/javascript" src="https://tech.hbc.com/assets/js/vendor/scrollmagic/ScrollMagic.min.js"></script>
<script type="text/javascript" src="https://tech.hbc.com/assets/js/vendor/jekyll-search-js/fetch.js"></script>
<script type="text/javascript" src="https://tech.hbc.com/assets/js/vendor/jekyll-search-js/search.js"></script>
<script type="text/javascript" src="https://tech.hbc.com/assets/js/main.js"></script>
<script type="text/javascript" src="https://tech.hbc.com/assets/js/vendor/snap/snap.svg-min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-106560024-1', 'auto');
  ga('send', 'pageview');
</script>


    </body>

</html>
